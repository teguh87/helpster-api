"use strict";var kinveyInitialized=!1;angular.module("helpsterApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl"}).otherwise({redirectTo:"/"})}]).config(["$httpProvider",function(a){a.defaults.useXDomain=!0,delete a.defaults.headers.common["X-Requested-With"]}]).run(["$rootScope","$location","$cookies","$http",function(a,b,c,d){a.globals=c.get("globals")||{},a.globals.currentUser&&(d.defaults.headers.common.Authorization="Basic "+a.globals.currentUser.authdata),a.$on("$locationChangeStart",function(c,d,e){"/login"===b.path()||a.globals.currentUser||b.path("/login")})}]),angular.module("helpsterApp").controller("MainCtrl",["$scope","$rootScope","$timeout","geocode","chat",function(a,b,c,d,e){function f(){d.init(),e.getChats().then(function(b){c(function(){a.places=b._items},100)}),google.maps.event.addListener(d.getMap(),"drag",function(a){c(function(){var a=d.getMap().getCenter(),c={geometry:{location:a}};d.getPlaceByGeoCoder(a).then(function(a){console.log(a.formatted_address),b.$broadcast("retriveQuery",{retrive:a.formatted_address})}),d.addMarker(c)},1e3)})}a.place={},a.error=!1,a.searchPlace="",a.status={},a.places=[];var g=function(){a.error=!1,d.search(a.searchPlace).then(function(f){c(function(){d.addMarker(f),a.place={name:f.name,desc:f.formatted_address,loc:{type:"Point",coordinates:[f.geometry.location.lat(),f.geometry.location.lng()]}},e.saveChat(a.place).then(function(a){console.log(a)}),a.places.push(a.place),b.$broadcast("retriveQuery",{retrive:""})},100)},function(b){a.error=!0,a.status=b})},h=a.$on("submitEvent",function(b,c){a.searchPlace=c.query,a.searchPlace&&g()});a.$on("$destroy",function(){h()}),f(),a.pointLocation=function(b){var c={lat:b.loc.coordinates[0],lng:b.loc.coordinates[1]},e={geometry:{location:c}};a.place=b,d.addMarker(e)}}]),angular.module("helpsterApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("helpsterApp").service("geocode",["$q","$timeout",function(a,b){this.init=function(){var a={center:new google.maps.LatLng(-6.187337,106.8222473),zoom:13,disableDefaultUI:!0};this.map=new google.maps.Map(document.getElementById("map"),a),this.addMarker({geometry:{location:this.map.getCenter()}}),this.places=new google.maps.places.PlacesService(this.map),this.geocoder=new google.maps.Geocoder},this.search=function(b){var c=a.defer();return this.places.textSearch({query:b},function(a,b){"OK"==b?c.resolve(a[0]):c.reject(b)}),c.promise},this.addMarker=function(a){this.marker&&this.marker.setMap(null),this.marker=new google.maps.Marker({map:this.map,position:a.geometry.location,animation:google.maps.Animation.DROP}),this.map.setCenter(a.geometry.location)},this.getMap=function(){return this.map},this.getPlaceByGeoCoder=function(b){var c=a.defer();return this.geocoder.geocode({location:b},function(a,b){"OK"===b?a[0]&&c.resolve(a[0]):c.reject(b)}),c.promise}}]),angular.module("helpsterApp").directive("map",function(){return{template:"<div></div>",restrict:"E",link:function(a,b,c){b.text("this is the map directive")}}}),angular.module("helpsterApp").factory("chat",["$http","$q",function(a,b){var c="http://localhost/";return{getChats:function(){return a.get(c+"chat").then(function(a){return a.data},function(a){console.error("Error while fetching chat"),b.reject(a)})},saveChat:function(d){return a.post(c+"chat",d).then(function(a){return a.data},function(a){console.error("Error while saving location"),b.reject(a)})}}}]),angular.module("helpsterApp").controller("HeaderCtrl",["$scope","$rootScope","$cookies",function(a,b,c){a.gPlace,a.query="",a.isAuth=c.get("globals")?!0:!1,a.eventGeocode=function(){b.$broadcast("submitEvent",{query:this.query})};var d=a.$on("retriveQuery",function(b,c){a.query=c.retrive,console.log(c)});a.$on("$destroy",function(){d()})}]),angular.module("helpsterApp").factory("auth",["base64","$http","$cookies","$rootScope","$timeout",function(a,b,c,d,e){var f={};return f.Login=function(a,b,c){e(function(){var d={success:"hr@helpster.asia"===a&&"betterhelpster"===b};d.success||(d.message="Username or password is incorrect"),c(d)},1e3)},f.SetCredentials=function(e,f){var g=a.encode(e+":"+f);d.globals={currentUser:{username:e,authdata:g}},b.defaults.headers.common.Authorization="Basic "+g,c.put("globals",d.globals)},f.ClearCredentials=function(){d.globals={},c.remove("globals"),b.defaults.headers.common.Authorization="Basic "},f}]),angular.module("helpsterApp").factory("base64",function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(b){var c,d,e,f,g,h="",i="",j="",k=0;do c=b.charCodeAt(k++),d=b.charCodeAt(k++),i=b.charCodeAt(k++),e=c>>2,f=(3&c)<<4|d>>4,g=(15&d)<<2|i>>6,j=63&i,isNaN(d)?g=j=64:isNaN(i)&&(j=64),h=h+a.charAt(e)+a.charAt(f)+a.charAt(g)+a.charAt(j),c=d=i="",e=f=g=j="";while(k<b.length);return h},decode:function(b){var c,d,e,f,g,h="",i="",j="",k=0,l=/[^A-Za-z0-9\+\/\=]/g;l.exec(b)&&window.alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),b=b.replace(/[^A-Za-z0-9\+\/\=]/g,"");do e=a.indexOf(b.charAt(k++)),f=a.indexOf(b.charAt(k++)),g=a.indexOf(b.charAt(k++)),j=a.indexOf(b.charAt(k++)),c=e<<2|f>>4,d=(15&f)<<4|g>>2,i=(3&g)<<6|j,h+=String.fromCharCode(c),64!=g&&(h+=String.fromCharCode(d)),64!=j&&(h+=String.fromCharCode(i)),c=d=i="",e=f=g=j="";while(k<b.length);return h}}}),angular.module("helpsterApp").controller("LoginCtrl",["$scope","$rootScope","$location","auth",function(a,b,c,d){d.ClearCredentials(),a.username="",a.password="",a.login=function(){a.dataLoading=!0,d.Login(a.username,a.password,function(b){b.success?(d.SetCredentials(a.username,a.password),c.path("/")):(a.error=b.message,a.dataLoading=!1)})}}]),angular.module("helpsterApp").directive("googleplace",function(){return{require:"ngModel",link:function(a,b,c,d){var e={types:[],componentRestrictions:{}};a.gPlace=new google.maps.places.Autocomplete(b[0],e),google.maps.event.addListener(a.gPlace,"place_changed",function(){a.$apply(function(){d.$setViewValue(b.val())})})}}}),angular.module("helpsterApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/login.html",'<div class="login-content"> <div class="login_form"> <div ng-show="error" class="alert alert-danger">{{error}}</div> <form name="form" ng-submit="login()" role="form"> <div class="form-group"> <label for="username">Username</label> <i class="fa fa-key"></i> <input type="text" name="username" id="username" class="form-control" ng-model="username" required> <span ng-show="form.username.$dirty && form.username.$error.required" class="help-block">Username is required</span> </div> <div class="form-group"> <label for="password">Password</label> <i class="fa fa-lock"></i> <input type="password" name="password" id="password" class="form-control" ng-model="password" required> <span ng-show="form.password.$dirty && form.password.$error.required" class="help-block">Password is required</span> </div> <div class="form-actions"> <button type="submit" ng-disabled="form.$invalid || dataLoading" class="btn btn-danger">Login</button> <img ng-if="dataLoading" src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="> </div> </form> </div> </div>'),a.put("views/main.html",'<div class="content_wrapper"> <div class="container-fluid"> <div class=""></div> <div class="map_section"> <div class="page-heading"> <div class="row d-flex align-items-center"> <div class="col-md-6"> <div class="page-breadcrumb"> <h1>Chat</h1> </div> </div> <div class="col-md-6 justify-content-md-end d-md-flex"> <div class="breadcrumb_nav"> <ol class="breadcrumb"> <li> <i class="material-icons"> home </i> <a class="parent-item" href="index.html">Home</a> <!-- <i class="fa fa-angle-right"></i> --> </li> <li class="active"> Chat </li> </ol> </div> </div> </div> </div> <div class="map_container"> <div class="row"> <div class="col-lg-6"> <div class="address_map card"> <div class="chart_header"> <div class="heading-bg"> <h3>Your Save Location</h3> </div> </div> <div class="chart-body"> <div class="list-group"> <a ng-click="pointLocation(p)" class="list-group-item list-group-item-action flex-column align-items-start" ng-class="{ \'active\' : place.name == p.name }" ng-repeat="p in places"> <div class="d-flex w-100 justify-content-between"> <h5 class="mb-1 text-light">{{p.name}}</h5> </div> <p class="mb-1 text-muted"> {{p.desc}} </p> </a> </div> </div> </div> </div> <div class="col-lg-6"> <div class="address_map card"> <div class="chart-body" id="map"></div> </div> </div> </div> </div> </div> </div> </div> ')}]);